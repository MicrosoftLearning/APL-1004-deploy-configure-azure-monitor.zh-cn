---
lab:
  title: 练习 - 监视 Web 应用
  module: Guided Project - Deploy and configure Azure Monitor
---

## 技能任务

- 启用 Application Insights
- 禁用 .NET Core 快照调试程序的日志记录
- 配置将网络应用程序 HTTP 日志写入日志分析工作区
- 将 SQL Insights 数据配置为写入日志分析工作区
- 启用 Web 应用程序的文件和配置更改跟踪

## 练习说明

### 启用 Application Insights

1. 在 Azure 门户搜索栏中输入 **rg-alpha**，然后从结果列表中选择 **rg-alpha**。
1. 从资源组中的项目列表中，选择**带有 SQL 数据库的 Web 应用程序的应用程序服务**。
1. 在**设置**下选择**Application Insights**。
1. 在**应用程序洞察**页面上，选择**打开应用程序洞察**。
1. 在**应用程序洞察**页面上，确保选择**创建新资源**，并将日志分析工作区设置为 **LogAnalytics1**，然后选择**应用**。
1. 在**应用监控设置**对话框中，选择**是**。

### 禁用 .NET Core 快照调试程序的日志记录

1. 在 Azure 门户搜索栏中输入 **rg-alpha**，然后从结果列表中选择 **rg-alpha**。
1. 从资源组中的项目列表中，选择**带有 SQL 数据库的 Web 应用程序的应用程序服务**。
1. 在**设置**下选择**Application Insights**。
1. 在**调试应用程序**下，选择 **.NET Core**，然后将快照调试器设置为**关**。 选择**应用**。
1. 在**应用监控设置**对话框中，选择**是**。

    | 属性 | 值    |
    |:---------|:---------|
    | 诊断设置名称  | httplogs   |
    | 类别    | HTTP 日志  |
    | 目标详细信息   | 发送到 Log Analytics 工作区  |
    | 订阅  | 你的订阅  |
    | Log Analytics 工作区   | LogAnalytics1   |

### 配置将网络应用程序 HTTP 日志写入日志分析工作区

1. 在 Azure 门户搜索栏中输入 **rg-alpha**，然后从结果列表中选择 **rg-alpha**。
1. 从资源组中的项目列表中，选择**带有 SQL 数据库的 Web 应用程序的应用程序服务**。
1. 在**监控**下，选择**诊断设置**。
1. 在**诊断设置**页上，选择 **+添加诊断设置**。
1. 在**诊断设置**页面上，选择以下内容并选择**保存**。

    | 属性 | 值    |
    |:---------|:---------|
    | 诊断设置名称  | httplogs   |
    | 类别    | HTTP 日志  |
    | 目标详细信息   | 发送到 Log Analytics 工作区  |
    | 订阅  | 你的订阅  |
    | Log Analytics 工作区   | LogAnalytics1   |

### 将 SQL Insights 数据配置为写入日志分析工作区

1. 在 Azure 门户搜索栏中输入 **rg-alpha**，然后从结果列表中选择 **rg-alpha**。
1. 从资源组中的项目列表中，选择示例 SQL 数据库。
1. 在**监控**下，选择**诊断设置**。
1. 在**诊断设置**页面上，选择**添加诊断设置**。
1. 在**诊断设置**页面上，提供以下信息并选择**保存**。

    | 属性 | 值    |
    |:---------|:---------|
    | 诊断设置名称  | InsightLogAnalytics   |
    | 类别    | SQL Insights  |
    | 目标详细信息   | 发送到 Log Analytics 工作区  |
    | 订阅  | 你的订阅  |
    | Log Analytics 工作区   | LogAnalytics1   |

### 启用 Web 应用程序的文件和配置更改跟踪

1. 在 Azure 门户搜索栏中输入 **rg-alpha**，然后从结果列表中选择 **rg-alpha**。
1. 从资源组中的项目列表中，选择 AzureLinuxAppWXYZ-webapp。
1. 选择**诊断和解决问题**。
1. 在搜索对话框中，键入**应用程序更改**。
1. 在**更改分析**页面上，选择**配置**。
1. 在**启用文件和配置更改跟踪**页面，将状态滑块更改为**开**，然后选择**保存**。
